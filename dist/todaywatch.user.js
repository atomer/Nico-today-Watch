/*!
// ==UserScript==
// @name        Nico today Watch
// @namespace   https://github.com/atomer/Nico-today-Watch
// @description 自分のウォッチリストで現在時間から指定時間以内に更新したユーザーを強調表示する
// @include     https://www.nicovideo.jp/my/top/user
// @include     https://www.nicovideo.jp/my/top
// @include     https://www.nicovideo.jp/my/watchlist*
// @grant       GM_addStyle
// @version     1.0.0
// ==/UserScript==
*/!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.listeners=null,this.listeners={}}return e.prototype.addEventListener=function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.removeEventListener=function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,o=n.length;r<o;r++)if(n[r]===t)return void n.splice(r,1)},e.prototype.dispatchEvent=function(e){if(!(e.type in this.listeners))return!0;for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++)t[n].call(this,e);return!e.defaultPrevented},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2).default()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(4),i=n(5);t.default=function(){var e=new r.default,t=new o.default(document.body),n=new i.default;e.addEventListener("update",(function(e){t.updateEmphasis(n.value,e.detail)})),n.addEventListener("change",(function(e){t.updateEmphasis(e.detail)})),e.insertRangeSwitch(n.el),t.updateEmphasis(n.value)}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var t=e.call(this)||this;return t.trigger(),t.loadStyle(),t.switchBase=document.querySelector("#nicorepo > H3"),t.switchBaseTarget=t.switchBase.querySelector(".a"),t.switchBase.parentNode.style.position="relative",t}return o(t,e),t.prototype.insertRangeSwitch=function(e){this.switchBase.insertBefore(e,this.switchBaseTarget)},t.prototype.loadStyle=function(){!function(e){var t=document.getElementsByTagName("head")[0];if(!t)return;var n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.appendChild(n)}([".ntw_visited:link {}",".ntw_visited:visited {color: #FFF !important;}"].join(""))},t.prototype.trigger=function(){var e=this,t=!1;u("#MyPageNicorepoApp",(function(){var n=document.querySelector(".NicorepoTimeline.timeline");if(!t&&n){var r=new CustomEvent("update",{detail:n.childNodes});e.dispatchEvent(r),u("timeline"+Date.now(),(function(t){var n=new CustomEvent("update",{detail:t.map((function(e){return e.addedNodes[0]}))});e.dispatchEvent(n)})),t=!0}}),!0)},t}(n(0).default);t.default=i;var a={};function u(e,t,n){void 0===n&&(n=!1),a[e]||(!function(e,t){new MutationObserver((function(t){a[e]&&a[e].forEach((function(e){return e(t)}))})).observe(document.querySelector(e),{childList:!0,subtree:t})}(e,n),a[e]=[]),a[e].push((function(e){t.apply(null,[e])}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={video:"#FDD",illust:"#9E9",live:"#DDF",mylist:"#FEE4B2",clip:"#DDD",stamp:"#DDD",intro:"#DDD",advert:"#DDD",achiev:"#DDD",none:"#DDD"},o="bold",i=function(){function e(e){this.el=e}return e.prototype.updateEmphasis=function(e,t){var n=this,r=+new Date;(t||this.el.querySelectorAll(".timeline .log")).forEach((function(t){var o=t.querySelector(".log-footer-date time");if(o){var i=o.getAttribute("datetime"),a=new Date(i);r-a.getTime()<function(e){return 864e5*e}(e)?n.emphasize(t,o):n.demphasize(t,o)}}))},e.prototype.emphasize=function(e,t){if(-1===e.className.indexOf("ntw_newer")){var n=e.className;e.setAttribute("data-nicotodaywatch-beforeclass",n),e.className=n+" ntw_newer";var i,u=e.querySelector(".log-body"),s=e.querySelector(".log-target-info");if(u){var c=(i=(i=u.textContent).replace(/^\s+|\s+$/g,""),/動画を投稿しました。$/.test(i)?"video":/イラストを投稿しました。$/.test(i)?"illust":/イラストをクリップしました。$/.test(i)?"clip":/生放送を開始しました。$/.test(i)?"live":/マイリスト登録しました。$/.test(i)?"mylist":/取得しました。$/.test(i)?"stamp":/紹介されました。$/.test(i)?"intro":/宣伝しました。$/.test(i)?"advert":/達成しました。$/.test(i)?"achiev":"none");e.style.backgroundColor=r[c],t.style.fontWeight=o,a(u,c)}s&&a(s)}},e.prototype.demphasize=function(e,t){var n=e.getAttribute("data-nicotodaywatch-beforeclass");n&&(e.className=n),e.removeAttribute("data-nicotodaywatch-beforeclass"),e.querySelector(".log-body")&&(e.style.backgroundColor="",t.style.fontWeight="")},e}();t.default=i;function a(e,t){var n;if("live"===t){if(e.querySelectorAll("A").forEach((function(e){e.getAttribute("title")||(n=e)})),!n)return}else n=e.querySelector("A");var r=n.className;n.setAttribute("class",r+" ntw_visited")}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a={1:"1日以内",2:"2日以内",3:"3日以内",4:"4日以内",5:"5日以内",6:"6日以内",7:"１週間以内",31:"１ヶ月以内"},u=function(e){function t(){var t=e.call(this)||this;t.value=1,t.el=document.createElement("div"),t.el.setAttribute("style","position:absolute;top:5px;right:5px;width:100px;");var n=function(e,t){var n=["<select>"];if("number"==typeof e)for(var r=0,o=function(e,t,n){for(var r=[],o=e<t,i=n?o?t+1:t-1:t,a=e;o?a<i:a>i;o?a++:a--)r.push(a);return r}(0,e,!1);r<o.length;r++){var i=o[r]+1;n.push('<option value="'+i+'"'+(t?" selected":"")+">"+i+"</option>")}else if("object"==typeof e)for(var a in e)n.push('<option value="'+a+'"'+(t===a?" selected":"")+">"+e[a]+"</option>");return n.join("</select>"),n.join("")}(a,t.value);t.el.innerHTML=n;var r=t.el.querySelector("SELECT");return r.addEventListener("change",(function(){t.value=parseInt(r.value,10);var e=new CustomEvent("change",{detail:t.value});t.dispatchEvent(e)}),!1),t}return o(t,e),t}(i.default);t.default=u}]);